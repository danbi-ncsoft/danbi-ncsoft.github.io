---
layout: post
title:  "인턴 생활기 시즌2 #4"
date:   2019-07-26 18:30:00
categories: ETC
author : DANBI
cover:  "/assets/img4.jpg"
---
이번 주에는 멘토, 멘티와의 점심 회식을 통해 회사 생활에 대한 이야기를 더 깊게 나눌 수 있었습니다. 또한 저희는 다양한 회의에 참석할 수 있었습니다. 먼저 팀에서 매주 수행하는 각 프로젝트 회의에 참석하여 멘토님들이 속한 프로젝트의 흐름을 파악할 수 있었습니다. 또한 유관 부서와 함께 진행하는 회의에 참석해서 저희 팀에서 구축한 분석 도구를 공유하고 요구사항을 조정하는 과정을 경험할 수 있었습니다.

### **Hive 예제 연습 **

이번 주에는 Hive DB에 있는 아이온, 블레이드앤소울 과 같은 PC 게임들의 유저 활동 데이터도 살펴보았습니다. 팀에서 쿼리 교육용으로 만들어 놓은 예제 문제들을 풀면서 쿼리에 대한 이해뿐만 아니라 테이블마다 어떤 정보가 담겨 있는지 파악할 수 있었습니다.

원하는 내용의 데이터를 추출하기 위해서는 여러 테이블들을 사용해야 하기 때문에 필요한 테이블들을 조인하고 데이터를 가공하는 일에 익숙해져야 합니다. 데이터 가공을 효율적으로 하기 위해서는 여러 함수들을 활용하는 것이 좋습니다. 내장되어 있는 많은 함수들 가운데 특정 기준에 따라 나열한 후 상위 몇 개의 값을 추출하는 `rank()` 함수나 그룹별로 나누어 값을 요약하는 `avg()`와 같은 함수가 가장 유용했던 것 같습니다. 

예를 들어, 블레이드앤소울에서 년6 개의 퀘스트를 살펴본다고 한다면, 해당 기간의 접속한 유저의 퀘스트 획득/완료 로그와 퀘스트명을 테이블에서 찾아야 했습니다계정과퀘스트를 그룹화한 뒤 `rank()`함수를 이용하면 낮은 완료율을 갖고 있는 퀘스트 하위 10개를 추출할 수 있습니다.

### **BOT 탐지**

#### - TensorBoard 활용하여 모델 시각화 하기

저희 팀에서는 자연어처리 분야에서 많이 사용되는 word2vec를 활용하여 게임에서 발생하는 행동 로그(word)를 벡터(vec)로 변형하는 작업을 진행했었는데요. 이 로직에 TensorBoard를 적용해 보았습니다. TensorBoard를 잘 활용하면, TensorFlow로 구현한 로직 및 결과를 쉽게 확인하고 잘 학습되고 있는지 학습 과정도 모니터링 할 수 있습니다.

TensorBoard를 사용하기 위해서는 writer와 name scope를 잘 활용하면 되는데요. SummaryWriter를 통해 로그를 저장할 경로를 지정해주고, 로그를 찍을 손실 함수나 레이어에 namescope 함수를 적용해서 이름을 지정해주면 됩니다. 

이렇게 name scope로 지정해 둔 스칼라 값을 `summary.merge`하여 writer에 한번에 넣는 간편함이 있습니다. (사실 word2vec 같은 경우에는 히든 레이어가 한 층으로 되어 있기 때문에 TensorBoard로 시각화할 필요는 없어 보이지만) TensorBoard 활용에 익숙해지면 앞으로 다룰 복잡한 모델도 한 눈에 볼 수 있는 장점이 있을 것입니다.

<p align="center">
<img src="/assets/etc/summer_intern/4_1.png" style="width:5in" />


</p>

위 그림처럼 데이터를 불러온 후 배치 처리를 위해 데이터를 전처리 하는 과정, 학습에 쓰이는 배치를 나누는 각 과정을 묶어서 볼 수 있었습니다. 

두 번째로는 특정 학습 step마다 train/validation loss를 출력해보았습니다.

<p align="center">
<img src="/assets/etc/summer_intern/4_2.png" style="width:6in" />


</p>

<p align="center"> (보안상의 이유로 이 부분은 TensorFlow 공식 문서 그래프를 첨부합니다.)
</p>

이를 통해 지금 학습하고 있는 모델의 loss값이 잘 줄어드는지, validation loss화 함께 비교해보며 과적합이 되고 있지는 않은지 확인할 수 있습니다.